# Terminal Composer Comparison: Ours vs VS Code/Cursor

## VS Code/Cursor Implementation (THEIRS)
Paste the outerHTML of their terminal with composer here:
<div class="terminal-split-pane">
   <div class="terminal-wrapper active" data-keybinding-context="87" style="display: flex; flex-direction: column;">
      <div class="xterm-wrapper" style="flex-grow: 1; flex-shrink: 1; min-height: 0px;">
         <div class="blocks-overlay"></div>
         <div dir="ltr" class="terminal xterm">
            <div class="xterm-accessibility" style="width: 469px; font-size: 12px;">
               <div role="list" class="xterm-accessibility-tree">
                  <div role="listitem" tabindex="-1" aria-posinset="1" aria-setsize="36" style="height: 14px; transform: scaleX(0.968881);">neel@Neels-MacBook-Air ~ % </div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="2" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="3" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="4" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="5" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="6" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="7" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="8" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="9" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="10" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="11" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="12" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="13" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="14" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="15" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="16" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="17" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="18" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="19" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="20" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="21" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="22" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="23" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="24" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="25" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="26" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="27" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="28" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="29" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="30" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="31" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="32" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="33" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="34" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="35" aria-setsize="36">&nbsp;</div>
                  <div role="listitem" tabindex="-1" style="height: 14px; transform: scaleX(0.968649);" aria-posinset="36" aria-setsize="36">&nbsp;</div>
               </div>
               <div class="live-region" aria-live="assertive">neel@Neels-MacBook-Air ~ % neel@Neels-MacBook-Air ~ % </div>
            </div>
            <canvas class="xterm-decoration-overview-ruler" width="28" height="1008" style="width: 14px; height: 504px;"></canvas>
            <div class="xterm-viewport"></div>
            <div class="xterm-scrollable-element mac" role="presentation" style="position: relative; background-color: rgb(248, 248, 248);">
               <div class="xterm-screen" style="width: 469px; height: 504px;">
                  <div class="xterm-helpers">
                     <textarea class="xterm-helper-textarea" aria-label="Terminal 4, zsh
                        Use ⌥F1 for terminal accessibility help" aria-multiline="false" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="left: 189px; top: 0px; width: 7px; height: 14px; line-height: 14px; z-index: -5;"></textarea>
                     <div class="composition-view"></div>
                  </div>
                  <style>.xterm .xterm-scrollable-element > .scrollbar > .slider {
                     background: #64646466;
                     }
                     .xterm .xterm-scrollable-element > .scrollbar > .slider:hover {
                     background: #646464b3;
                     }
                     .xterm .xterm-scrollable-element > .scrollbar > .slider.active {
                     background: #00000099;
                     }
                  </style>
                  <div class="xterm-decoration-container">
                     <div class="codicon xterm-decoration default terminal-command-decoration default-color codicon-terminal-decoration-incomplete" style="width: 16px; height: 16px; top: 0px; line-height: 14px; display: block; font-size: 16px; margin-left: -17px;"></div>
                  </div>
                  <div class="terminal-widget-container"></div>
                  <canvas class="xterm-link-layer" width="938" height="1008" style="z-index: 2; width: 469px; height: 504px;"></canvas>
                  <canvas width="938" height="1008" style="width: 469px; height: 504px;"></canvas>
               </div>
               <div role="presentation" aria-hidden="true" class="invisible scrollbar horizontal" style="position: absolute; width: 0px; height: 0px; left: 0px; bottom: 0px;">
                  <div class="slider" style="position: absolute; top: 0px; left: 0px; height: 0px; transform: translate3d(0px, 0px, 0px); contain: strict; width: 0px;"></div>
               </div>
               <div role="presentation" aria-hidden="true" class="invisible scrollbar vertical" style="position: absolute; width: 14px; height: 504px; right: 0px; top: 0px;">
                  <div class="slider" style="position: absolute; top: 0px; left: 0px; width: 14px; transform: translate3d(0px, 0px, 0px); contain: strict; height: 504px;"></div>
               </div>
            </div>
         </div>
      </div>
      <div class="prompt-bar-container" style="display: block; top: 20px; width: 100%; z-index: 10000;">
         <div style="height: 100%; width: 100%;">
            <div class="terminal-prompt-bar-container">
               <div class="terminal-prompt-bar-inner">
                  <div class="terminal-prompt-bar-input-row">
                     <div class="terminal-prompt-bar-input">
                        <div style="width: 100%; overflow: hidden;">
                           <div class="aislash-editor-grid" style="display: grid; position: relative; grid-template-columns: 1fr 1fr; width: 200%;">
                              <div autocapitalize="off" class="aislash-editor-input" contenteditable="true" spellcheck="false" data-lexical-editor="true" role="textbox" style="resize: none; grid-area: 1 / 1 / 1 / 1; overflow: hidden; line-height: 1.5; font-family: inherit; font-size: 13px; color: var(--vscode-input-foreground); background-color: transparent; display: block; outline: none; scrollbar-width: none; box-sizing: border-box; border: none; overflow-wrap: break-word; word-break: break-word; padding: 0px 0.5rem; user-select: text; white-space: pre-wrap;">
                                 <p><br></p>
                              </div>
                              <div style="grid-area: 1 / 2 / 1 / 2;">
                                 <div class="aislash-editor-placeholder" style="position: relative; top: 0px; left: -100%; padding: 0px 0.5rem; pointer-events: none; user-select: none; line-height: 1.5; font-size: 13px; color: var(--vscode-input-placeholderForeground); opacity: 0.5;">Command instructions</div>
                              </div>
                           </div>
                        </div>
                     </div>
                     <div class="terminal-prompt-bar-close"><button class="prompt-bar-close-btn" type="button" title="Close"><span class="codicon codicon-x"></span></button></div>
                  </div>
                  <div class="terminal-prompt-bar-actions-row">
                     <div class="terminal-prompt-bar-actions-spacer"></div>
                     <div class="cursor-button cursor-button-secondary cursor-button-secondary-clickable disabled" style="margin-right: 8px; font-size: 10px; padding: 0px 4px;">Quick Question</div>
                     <div class="anysphere-icon-button bg-[transparent] border-none text-[var(--cursor-text-primary)] flex w-4 items-center justify-center terminal-prompt-bar-icon-button " data-variant="background" data-disabled="true" style="width: 20px; height: 20px;"><span class="codicon codicon-arrow-up-two !text-[16px] undefined "></span></div>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</div>
---

## VYBE Implementation (OURS)
Paste the outerHTML of our terminal with composer here:
<div class="terminal-split-pane">
   <div class="terminal-wrapper active" data-keybinding-context="11" style="display: flex; flex-direction: column;">
      <div>
         <div dir="ltr" class="terminal xterm">
            <canvas class="xterm-decoration-overview-ruler" width="28" height="840" style="width: 14px; height: 420px;"></canvas>
            <div class="xterm-viewport"></div>
            <div class="xterm-scrollable-element  mac" role="presentation" style="position: relative; background-color: rgb(255, 255, 255);">
               <div class="xterm-screen" style="width: 756px; height: 420px;">
                  <div class="xterm-helpers">
                     <textarea class="xterm-helper-textarea" aria-label="Terminal 1, zsh
                        Run the command: Toggle Screen Reader Accessibility Mode for an optimized screen reader experience
                        Use ⌥F1 for terminal accessibility help" aria-multiline="false" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="left: 238px; top: 0px; width: 7px; height: 14px; line-height: 14px; z-index: -5;"></textarea>
                     <div class="composition-view"></div>
                  </div>
                  <style>.xterm .xterm-scrollable-element > .scrollbar > .slider {
                     background: #64646466;
                     }
                     .xterm .xterm-scrollable-element > .scrollbar > .slider:hover {
                     background: #646464b3;
                     }
                     .xterm .xterm-scrollable-element > .scrollbar > .slider.active {
                     background: #00000099;
                     }
                  </style>
                  <div class="xterm-decoration-container">
                     <div class="terminal-command-decoration codicon codicon-terminal-decoration-incomplete xterm-decoration default-color default" style="width: 16px; height: 16px; top: 0px; line-height: 14px; display: block; font-size: 16px; margin-left: -17px;"></div>
                  </div>
                  <div class="terminal-widget-container"></div>
                  <canvas class="xterm-link-layer" width="1512" height="840" style="z-index: 2; width: 756px; height: 420px;"></canvas>
                  <canvas width="1512" height="840" style="width: 756px; height: 420px;"></canvas>
               </div>
               <div role="presentation" aria-hidden="true" class="invisible scrollbar horizontal" style="position: absolute; width: 0px; height: 0px; left: 0px; bottom: 0px;">
                  <div class="slider" style="position: absolute; top: 0px; left: 0px; height: 0px; transform: translate3d(0px, 0px, 0px); contain: strict; width: 0px;"></div>
               </div>
               <div role="presentation" aria-hidden="true" class="invisible scrollbar vertical" style="position: absolute; width: 14px; height: 420px; right: 0px; top: 0px;">
                  <div class="slider" style="position: absolute; top: 0px; left: 0px; width: 14px; transform: translate3d(0px, 0px, 0px); contain: strict; height: 420px;"></div>
               </div>
            </div>
         </div>
      </div>
      <div class="prompt-bar-container vybe-terminal-inline-chat" style="display: block; position: relative !important; width: 100% !important; flex-shrink: 0 !important; padding: 0px 10px !important; box-sizing: border-box !important; inset: auto !important; z-index: auto !important; transform: none !important; margin: 0px !important;">
         <div class="prompt-bar-hint" style="display: none; text-align: center; opacity: 1; color: var(--vscode-input-placeholderForeground); font-size: 10px; height: 20px; line-height: 20px; cursor: pointer;"><code>Vybe Agent</code> to run Agent • ⌘I to generate command</div>
         <div style="height: 100%; width: 100%; display: block;">
            <div class="terminal-prompt-bar-container" style="padding: 0px 10px;">
               <div class="terminal-prompt-bar-inner" style="display: flex; flex-direction: column; gap: 8px; padding: 8px 8px 4px; background-color: rgb(236, 239, 242); border: 1px solid rgb(217, 217, 217); border-radius: 8px; box-sizing: border-box;">
                  <div class="vybe-terminal-inline-composer-context-pills-toolbar" style="display: none;">
                     <div class="vybe-terminal-inline-composer-context-pills"></div>
                  </div>
                  <div class="terminal-prompt-bar-chat-response" style="display: none;"></div>
                  <div class="terminal-prompt-bar-input-row">
                     <div class="terminal-prompt-bar-input">
                        <div style="width: 100%; overflow: hidden;">
                           <div class="aislash-editor-grid" style="display: grid; position: relative; grid-template-columns: 1fr 1fr; width: 200%;">
                              <div class="aislash-editor-input" contenteditable="true" spellcheck="false" autocapitalize="off" role="textbox" style="resize: none; grid-area: 1 / 1 / 1 / 1; overflow: hidden; line-height: 1.5; font-family: inherit; font-size: 13px; color: var(--vscode-input-foreground); background-color: transparent; display: block; outline: none; scrollbar-width: none; box-sizing: border-box; border: none; overflow-wrap: break-word; word-break: break-word; padding: 0px 0.5rem; user-select: text; white-space: pre-wrap;"></div>
                              <div style="grid-area: 1 / 2 / 1 / 2;">
                                 <div class="aislash-editor-placeholder" style="position: relative; top: 0px; left: -100%; padding: 0px 0.5rem; pointer-events: none; user-select: none; line-height: 1.5; font-size: 13px; color: var(--vscode-input-placeholderForeground); opacity: 0.5;">Add a follow-up</div>
                              </div>
                           </div>
                        </div>
                     </div>
                     <div class="terminal-prompt-bar-close"><button class="prompt-bar-close-btn" type="button" title="Collapse"><span class="codicon codicon-x"></span></button></div>
                  </div>
                  <div class="terminal-prompt-bar-actions-row">
                     <div class="terminal-prompt-bar-actions-spacer"></div>
                     <div class="cursor-button cursor-button-secondary cursor-button-secondary-clickable" style="margin-right: 8px; font-size: 10px; padding: 0px 4px;">Quick Question</div>
                     <div class="anysphere-icon-button bg-[transparent] border-none text-[var(--cursor-text-primary)] flex w-4 items-center justify-center terminal-prompt-bar-icon-button" style="width: 20px; height: 20px;"><span class="codicon codicon-arrow-up-two" style="font-size: 16px; cursor: pointer;"></span><span class="codicon codicon-debug-stop" style="font-size: 16px; cursor: pointer;"></span></div>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</div>
---

## Key Differences Analysis

### 1. HTML Structure

**THEIRS (VS Code/Cursor):**
```
terminal-wrapper (flex column)
├── xterm-wrapper (flex-grow: 1, flex-shrink: 1, min-height: 0px)
│   └── terminal xterm (actual terminal)
└── prompt-bar-container (DIRECT CHILD, sibling of xterm-wrapper)
    └── terminal-prompt-bar-container
        └── terminal-prompt-bar-inner
```

**OURS (VYBE):**
```
terminal-wrapper (flex column)
├── <div> (NO xterm-wrapper class!)
│   └── terminal xterm (actual terminal)
└── vybe-terminal-inline-chat (DIRECT CHILD, sibling of div)
    └── prompt-bar-container (NESTED inside vybe-terminal-inline-chat)
        ├── prompt-bar-hint (hint bar)
        └── terminal-prompt-bar-container (composer, hidden)
```

**CRITICAL DIFFERENCE:**
- **Theirs:** `prompt-bar-container` is a DIRECT CHILD of `terminal-wrapper` (same level as `xterm-wrapper`)
- **Ours:** `prompt-bar-container` is NESTED inside `vybe-terminal-inline-chat`, which is a direct child
- **Theirs:** Has `xterm-wrapper` wrapper around terminal
- **Ours:** Missing `xterm-wrapper` - terminal is in a plain `<div>`

### 2. CSS Positioning

**THEIRS:**
- `prompt-bar-container` has: `style="display: block; top: 20px; width: 100%; z-index: 10000;"`
- **PROBLEM:** `top: 20px` makes it absolutely positioned, causing overlay at top
- `xterm-wrapper` has: `flex-grow: 1; flex-shrink: 1; min-height: 0px;`

**OURS:**
- `vybe-terminal-inline-chat` has: `position: relative; width: 100%; flex-shrink: 0; display: block; inset: auto; z-index: auto;`
- `prompt-bar-container` has: `display: block !important; position: relative !important; ... inset: auto !important; z-index: auto !important;`
- **GOOD:** All positioning is `auto` or `relative`, no absolute positioning
- Missing `xterm-wrapper` wrapper, so terminal is in plain `<div>` without flex properties

### 3. Container Hierarchy

**THEIRS:**
```
terminal-wrapper
  ├── xterm-wrapper (flex child, takes available space)
  └── prompt-bar-container (flex child, fixed size, stacks at bottom)
```

**OURS:**
```
terminal-wrapper
  ├── <div> (plain div, no flex properties)
  │   └── terminal xterm
  └── vybe-terminal-inline-chat (flex child, fixed size)
      └── prompt-bar-container (nested, no flex properties)
```

**ISSUE:** Our terminal is not wrapped in `xterm-wrapper`, so it doesn't have `flex-grow: 1` to take available space.

### 4. Flex Layout

**THEIRS:**
- `terminal-wrapper`: `display: flex; flex-direction: column;`
- `xterm-wrapper`: `flex-grow: 1; flex-shrink: 1; min-height: 0px;` (takes available space)
- `prompt-bar-container`: No flex properties (natural size, stacks at bottom)

**OURS:**
- `terminal-wrapper`: `display: flex; flex-direction: column;` ✅
- `<div>` (terminal container): NO flex properties ❌
- `vybe-terminal-inline-chat`: `flex-shrink: 0;` ✅
- `prompt-bar-container`: No flex properties ✅

**PROBLEM:** Our terminal container div doesn't have `flex-grow: 1` to take available space, so it might not be sizing correctly.

### 5. Z-Index & Stacking

**THEIRS:**
- `prompt-bar-container`: `z-index: 10000;` + `top: 20px;` = **OVERLAYS at top** ❌

**OURS:**
- `vybe-terminal-inline-chat`: `z-index: auto;` ✅
- `prompt-bar-container`: `z-index: auto !important;` ✅
- **GOOD:** No z-index stacking, normal document flow

### 6. Visibility States

**THEIRS:**
- `prompt-bar-container`: Always `display: block;` when visible
- No hint bar - goes straight to full composer

**OURS:**
- `prompt-bar-container`: Always `display: block !important;`
- `prompt-bar-hint`: `display: block;` (hint bar always visible)
- `terminal-prompt-bar-container`: `display: none;` (composer hidden by default)
- **GOOD:** Has collapsible hint bar → full composer

## ROOT CAUSE ANALYSIS

### Primary Issues:

1. **Missing `xterm-wrapper`:** Our terminal is not wrapped in `xterm-wrapper`, so it doesn't get `flex-grow: 1` to take available space. The terminal container is just a plain `<div>`.

2. **Nested Structure:** We have an extra wrapper (`vybe-terminal-inline-chat`) that theirs doesn't have. Theirs has `prompt-bar-container` as a direct child of `terminal-wrapper`.

3. **VS Code's JavaScript:** VS Code's terminal chat code is adding `top: 20px` and `z-index: 10000` to `prompt-bar-container` via JavaScript, which makes it absolutely positioned and overlay at the top. This happens even in their own implementation!

### What We Need to Fix:

1. **Ensure terminal is wrapped in `xterm-wrapper`** with proper flex properties
   - VS Code creates `xterm-wrapper` automatically, but our terminal might not have it
   - We need to find or create `xterm-wrapper` and ensure it has `flex-grow: 1`

2. **Make `prompt-bar-container` a direct child of `terminal-wrapper`** (remove `vybe-terminal-inline-chat` wrapper, or make it just a class on `prompt-bar-container`)
   - Currently: `terminal-wrapper` > `vybe-terminal-inline-chat` > `prompt-bar-container`
   - Should be: `terminal-wrapper` > `prompt-bar-container` (direct child, sibling of `xterm-wrapper`)

3. **Keep MutationObserver** to prevent VS Code from adding positioning styles
   - VS Code's JavaScript adds `top: 20px` and `z-index: 10000` even in their own implementation
   - Our MutationObserver must override these immediately

4. **Match their structure exactly:**
   ```
   terminal-wrapper (flex column)
   ├── xterm-wrapper (flex-grow: 1, flex-shrink: 1, min-height: 0)
   │   └── terminal xterm
   └── prompt-bar-container (flex-shrink: 0, stacks at bottom)
   ```

### Implementation Fix:

The key issue is that `_terminalElement` (from `instance.domElement`) IS the `terminal-wrapper`, not `xterm-wrapper`. So we should:

1. Use `_terminalElement` directly as `terminal-wrapper` (don't use `closest()`)
2. Find `xterm-wrapper` inside `_terminalElement` using `querySelector('.xterm-wrapper')`
3. If `xterm-wrapper` doesn't exist, we might need to wrap the terminal in it, OR the terminal structure is different
4. Append `prompt-bar-container` directly to `_terminalElement` (which is `terminal-wrapper`)

### Critical Discovery:

Looking at the HTML:
- **THEIRS:** Has `xterm-wrapper` with class and flex properties
- **OURS:** Has plain `<div>` without `xterm-wrapper` class

This suggests VS Code creates `xterm-wrapper` automatically, but maybe it's not being created in our case, or we're looking at a different terminal structure. We need to check if `xterm-wrapper` exists, and if not, understand why.

